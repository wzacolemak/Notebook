---
comments: true
---
# CVE-2022-38181

> 原文链接：[Pwning the all Google phone with a non-Google bug](https://github.blog/security/vulnerability-research/pwning-the-all-google-phone-with-a-non-google-bug/){:target="_blank"}

!!! abstrct

    Pixel 6 是第一台号称“全谷歌”的手机，但它存在一个“非谷歌”漏洞 —— Arm Mali GPU CVE-2022-38181，通过这个漏洞可以实现任意内核代码执行和获取root权限，本文将介绍这个漏洞的利用方法。

## The Arm Mali GPU

Arm Mali GPU 被广泛集成于各类设备中。安卓手机的GPU Driver是一个易于受到攻击的目标，因为它们可以直接被不可信app访问并且所有的安卓设备GPU均为 Qualcomm's Adreno 或 Arm Mali GPU，这意味着任何微小的bug都将覆盖大量设备。

事实上，2021年爆出的7个Android 0-day漏洞中有5个是针对GPU的，最近的在野利用bug为CVE-2021-39793，于2022年3月披露。包括本漏洞在内，Qualcomm Adreno 和 Arm Mali GPU 各被爆出过3个漏洞。

由于用户空间应用和GPU间内存管理的复杂性，在Arm Mali GPU的内存管理代码中有许多隐患。本漏洞涉及到GPU内存中一个特殊类型：`JIT memory`。

这里的 `JIT` 不是指编译里提到的即时编译，因为它是作为 non-excutable memory 创建的，被用作GPU kernel Driver的 memory cache，能够即时与用户程序共享。当内存不足时，它会返回给kernel使用。

许多其它类型的GPU memory都是通过 ioctl call（例如`KBASE_IOCTL_MEM_IMPORT`） 直接创建的。

